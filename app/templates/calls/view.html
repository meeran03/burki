<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call {{ call.call_sid }} - VAPI Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://unpkg.com/wavesurfer.js@7/dist/wavesurfer.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js@7/dist/plugins/regions.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js@7/dist/plugins/timeline.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'vapi-blue': '#2563eb',
                        'vapi-light': '#f8fafc',
                        'vapi-gray': '#64748b'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .glass-effect { 
            backdrop-filter: blur(10px); 
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .chat-bubble { 
            animation: slideIn 0.3s ease-out;
            max-width: 85%;
            transition: all 0.3s ease;
        }
        .chat-bubble.highlighted {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
        }
        .chat-bubble.highlighted .bg-white {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important;
            color: #92400e !important;
        }
        .chat-bubble.highlighted .bg-gradient-to-br {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .audio-player {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .status-badge {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
        }
        .waveform-container {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        .waveform-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #3b82f6, #10b981, #8b5cf6);
            opacity: 0.7;
        }
        .audio-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        .control-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            border: none;
            border-radius: 8px;
            padding: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
        }
        .control-btn:active {
            transform: translateY(0);
        }
        .time-display {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 6px;
            color: white;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 500;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 14px;
        }
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
        #waveform {
            height: 128px;
            margin: 10px 0;
        }
        #timeline {
            height: 20px;
            margin-top: 10px;
        }
        .transcript-item {
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            padding: 4px;
        }
        .transcript-item:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        .playing-indicator {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
    <!-- Header -->
    <div class="gradient-bg text-white py-6 px-6 shadow-lg">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <a href="/calls" class="flex items-center text-white hover:text-blue-200 transition-colors">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                        Back to Calls
                    </a>
                </div>
                <h1 class="text-2xl font-bold">Call Details</h1>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- Call Header Card -->
        <div class="glass-effect rounded-2xl p-6 mb-8 shadow-xl">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800">{{ call.call_sid }}</h2>
                <span class="status-badge text-white px-4 py-2 rounded-full text-sm font-semibold">
                    {{ call.status.title() }}
                </span>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="flex items-center space-x-3">
                    <div class="p-2 bg-blue-100 rounded-lg">
                        <i data-lucide="phone" class="w-5 h-5 text-blue-600"></i>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">From → To</p>
                        <p class="font-semibold text-gray-800">{{ call.customer_phone_number }} → {{ call.to_phone_number }}</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <div class="p-2 bg-green-100 rounded-lg">
                        <i data-lucide="clock" class="w-5 h-5 text-green-600"></i>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Duration</p>
                        <p class="font-semibold text-gray-800">
                            {% if call.duration %}
                                {{ call.duration }} seconds
                            {% else %}
                                N/A
                            {% endif %}
                        </p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <div class="p-2 bg-purple-100 rounded-lg">
                        <i data-lucide="calendar" class="w-5 h-5 text-purple-600"></i>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Started</p>
                        <p class="font-semibold text-gray-800">{{ call.started_at.strftime('%B %d, %Y at %H:%M') if call.started_at else 'N/A' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left Column: Call Info & Recordings -->
            <div class="space-y-6">
                <!-- Call Information -->
                <div class="glass-effect rounded-2xl p-6 shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i data-lucide="info" class="w-5 h-5 mr-2 text-blue-600"></i>
                        Call Information
                    </h3>
                    
                    <div class="space-y-4">
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Assistant</span>
                            <span class="font-semibold text-blue-600">{{ call.assistant.name if call.assistant else 'N/A' }}</span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Status</span>
                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                                {{ call.status.title() }}
                            </span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2 border-b border-gray-100">
                            <span class="text-gray-600">Duration</span>
                            <span class="font-semibold text-gray-800">
                                {% if call.duration %}
                                    {{ call.duration }} seconds
                                {% else %}
                                    N/A
                                {% endif %}
                            </span>
                        </div>
                        
                        <div class="flex justify-between items-center py-2">
                            <span class="text-gray-600">Ended</span>
                            <span class="font-semibold text-gray-800">
                                {{ call.ended_at.strftime('%B %d, %Y at %H:%M') if call.ended_at else 'N/A' }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Interactive Audio Player with Waveform -->
                <div class="glass-effect rounded-2xl p-6 shadow-xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i data-lucide="mic" class="w-5 h-5 mr-2 text-red-600"></i>
                        Interactive Audio Player
                    </h3>
                    
                    {% if recordings %}
                        {% set recording_with_file = recordings|selectattr('status', 'equalto', 'completed')|selectattr('file_path')|first %}
                        
                        {% if recording_with_file %}
                            <div class="waveform-container">
                                <div class="audio-controls">
                                    <button id="playBtn" class="control-btn">
                                        <i data-lucide="play" class="w-5 h-5"></i>
                                    </button>
                                    <button id="pauseBtn" class="control-btn" style="display: none;">
                                        <i data-lucide="pause" class="w-5 h-5"></i>
                                    </button>
                                    <button id="stopBtn" class="control-btn">
                                        <i data-lucide="square" class="w-5 h-5"></i>
                                    </button>
                                    <div class="time-display">
                                        <span id="currentTime">00:00</span> / <span id="totalTime">00:00</span>
                                    </div>
                                    <div class="flex-1"></div>
                                    <div class="playing-indicator" id="playingIndicator" style="display: none;">
                                        <i data-lucide="radio" class="w-5 h-5 text-green-400"></i>
                                    </div>
                                </div>
                                
                                <div id="waveform"></div>
                                <div id="timeline"></div>
                                
                                <div class="legend">
                                    <div class="legend-item">
                                        <div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);"></div>
                                        <span>User Speech</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background: linear-gradient(135deg, #10b981, #047857);"></div>
                                        <span>AI Speech</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color" style="background: linear-gradient(135deg, #6b7280, #4b5563);"></div>
                                        <span>Silence</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex space-x-2 mt-4">
                                <a href="/calls/{{ call.id }}/recording/{{ recording_with_file.id }}" 
                                   class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium">
                                    <i data-lucide="download" class="w-4 h-4 mr-2"></i>
                                    Download
                                </a>
                            </div>
                            
                            <script>
                                // Store audio URL for waveform
                                window.audioUrl = '/calls/{{ call.id }}/recording/{{ recording_with_file.id }}/play';
                            </script>
                            
                            <!-- Store transcript data as JSON -->
                            <script type="application/json" id="transcript-data">
                                [
                                    {% for transcript in transcripts %}
                                    {
                                        "id": {{ loop.index0 }},
                                        "speaker": {{ transcript.speaker|tojson }},
                                        "content": {{ transcript.content|tojson }},
                                        "startTime": {{ loop.index0 * 2 }},
                                        "endTime": {{ (loop.index0 + 1) * 2 }},
                                        "timestamp": {{ transcript.created_at.strftime('%H:%M:%S')|tojson if transcript.created_at else 'N/A'|tojson }}
                                    }{% if not loop.last %},{% endif %}
                                    {% endfor %}
                                ]
                            </script>
                        {% else %}
                            <div class="text-center py-8">
                                <i data-lucide="mic-off" class="w-12 h-12 text-gray-400 mx-auto mb-3"></i>
                                <p class="text-gray-600">Recording not available locally for waveform visualization</p>
                                {% set completed_recording = recordings|selectattr('status', 'equalto', 'completed')|first %}
                                {% if completed_recording %}
                                    <a href="/calls/{{ call.id }}/recording/{{ completed_recording.id }}" 
                                       class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium mt-4">
                                        <i data-lucide="external-link" class="w-4 h-4 mr-2"></i>
                                        View on Twilio
                                    </a>
                                {% endif %}
                            </div>
                        {% endif %}
                    {% else %}
                        <div class="text-center py-8">
                            <i data-lucide="mic-off" class="w-12 h-12 text-gray-400 mx-auto mb-3"></i>
                            <p class="text-gray-600">No recordings available for this call</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Right Column: Interactive Conversation Transcript -->
            <div class="space-y-6">
                <div class="glass-effect rounded-2xl p-6 shadow-xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center">
                            <i data-lucide="message-square" class="w-5 h-5 mr-2 text-green-600"></i>
                            Interactive Transcript
                        </h3>
                        
                        {% if transcripts %}
                            <div class="flex space-x-2">
                                <a href="/calls/{{ call.id }}/transcripts/export?format=txt" 
                                   class="inline-flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium">
                                    <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                                    Export TXT
                                </a>
                                <a href="/calls/{{ call.id }}/transcripts/export?format=json" 
                                   class="inline-flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium">
                                    <i data-lucide="file-code" class="w-4 h-4 mr-2"></i>
                                    Export JSON
                                </a>
                            </div>
                        {% endif %}
                    </div>
                    
                    {% if transcripts %}
                        <div class="space-y-4 max-h-96 overflow-y-auto pr-2" id="transcriptContainer" style="scrollbar-width: thin;">
                            {% for transcript in transcripts %}
                                <div class="chat-bubble transcript-item {% if transcript.speaker == 'assistant' %}ml-auto{% endif %}" 
                                     data-transcript-id="{{ loop.index0 }}">
                                    <div class="flex items-start space-x-3 {% if transcript.speaker == 'assistant' %}flex-row-reverse space-x-reverse{% endif %}">
                                        <div class="flex-shrink-0">
                                            {% if transcript.speaker == 'assistant' %}
                                                <div class="w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center">
                                                    <i data-lucide="bot" class="w-4 h-4 text-white"></i>
                                                </div>
                                            {% else %}
                                                <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center">
                                                    <i data-lucide="user" class="w-4 h-4 text-white"></i>
                                                </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="flex-1">
                                            <div class="{% if transcript.speaker == 'assistant' %}bg-gradient-to-br from-green-500 to-green-600 text-white{% else %}bg-white border{% endif %} rounded-2xl px-4 py-3 shadow-sm">
                                                <p class="text-sm {% if transcript.speaker == 'assistant' %}text-white{% else %}text-gray-800{% endif %}">
                                                    {{ transcript.content }}
                                                </p>
                                            </div>
                                            
                                            <div class="flex items-center mt-1 {% if transcript.speaker == 'assistant' %}justify-end{% endif %}">
                                                <span class="text-xs text-gray-500">
                                                    {{ transcript.speaker.title() }} • {{ transcript.created_at.strftime('%H:%M:%S') if transcript.created_at else 'N/A' }}
                                                    {% if transcript.confidence %}
                                                        • {{ "%.0f"|format(transcript.confidence * 100) }}% confidence
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        
                        <div class="mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="flex items-center text-sm text-blue-700">
                                <i data-lucide="info" class="w-4 h-4 mr-2"></i>
                                <span>Click on transcript segments to seek audio, or click waveform regions to highlight transcripts</span>
                            </div>
                        </div>
                    {% else %}
                        <div class="text-center py-12">
                            <i data-lucide="message-circle" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                            <h4 class="text-lg font-semibold text-gray-600 mb-2">No Conversation Yet</h4>
                            <p class="text-gray-500">Transcripts will appear here once the conversation begins</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Global variables for audio player
        let wavesurfer = null;
        let regions = null;
        let isPlaying = false;
        let currentRegion = null;
        
        // Initialize WaveSurfer when audio URL is available
        if (window.audioUrl) {
            document.addEventListener('DOMContentLoaded', function() {
                // Load transcript data from JSON script tag
                const transcriptDataElement = document.getElementById('transcript-data');
                if (transcriptDataElement) {
                    try {
                        window.transcriptData = JSON.parse(transcriptDataElement.textContent);
                        initializeWaveform();
                    } catch (e) {
                        console.error('Error parsing transcript data:', e);
                    }
                } else {
                    initializeWaveform();
                }
                
                // Add click handlers for transcript items
                addTranscriptClickHandlers();
            });
        } else {
            // Even without audio, set up transcript click handlers
            document.addEventListener('DOMContentLoaded', function() {
                addTranscriptClickHandlers();
            });
        }
        
        function initializeWaveform() {
            // Create WaveSurfer instance
            wavesurfer = WaveSurfer.create({
                container: '#waveform',
                waveColor: 'rgba(99, 102, 241, 0.8)',
                progressColor: 'rgba(59, 130, 246, 1)',
                cursorColor: '#ffffff',
                barWidth: 2,
                barRadius: 3,
                responsive: true,
                height: 128,
                normalize: true,
                backend: 'WebAudio',
                mediaControls: false
            });
            
            // Initialize regions plugin
            regions = wavesurfer.registerPlugin(WaveSurfer.Regions.create());
            
            // Initialize timeline plugin
            const timeline = wavesurfer.registerPlugin(WaveSurfer.Timeline.create({
                height: 20,
                timeInterval: 10,
                primaryLabelInterval: 30,
                style: {
                    fontSize: '12px',
                    color: '#ffffff'
                }
            }));
            
            // Load audio
            wavesurfer.load(window.audioUrl);
            
            // Event listeners
            wavesurfer.on('ready', function() {
                const duration = wavesurfer.getDuration();
                updateTimeDisplay(0, duration);
                createTranscriptRegions(duration);
            });
            
            wavesurfer.on('play', function() {
                isPlaying = true;
                document.getElementById('playBtn').style.display = 'none';
                document.getElementById('pauseBtn').style.display = 'block';
                document.getElementById('playingIndicator').style.display = 'block';
            });
            
            wavesurfer.on('pause', function() {
                isPlaying = false;
                document.getElementById('playBtn').style.display = 'block';
                document.getElementById('pauseBtn').style.display = 'none';
                document.getElementById('playingIndicator').style.display = 'none';
            });
            
            wavesurfer.on('finish', function() {
                isPlaying = false;
                document.getElementById('playBtn').style.display = 'block';
                document.getElementById('pauseBtn').style.display = 'none';
                document.getElementById('playingIndicator').style.display = 'none';
            });
            
            wavesurfer.on('timeupdate', function(currentTime) {
                updateTimeDisplay(currentTime, wavesurfer.getDuration());
                highlightCurrentTranscript(currentTime);
            });
            
            // Control button events
            document.getElementById('playBtn').addEventListener('click', function() {
                wavesurfer.play();
            });
            
            document.getElementById('pauseBtn').addEventListener('click', function() {
                wavesurfer.pause();
            });
            
            document.getElementById('stopBtn').addEventListener('click', function() {
                wavesurfer.stop();
                clearTranscriptHighlight();
            });
            
            // Region click events
            regions.on('region-clicked', function(region, e) {
                e.stopPropagation();
                highlightTranscriptById(region.id);
                wavesurfer.setTime(region.start);
            });
        }
        
        function createTranscriptRegions(totalDuration) {
            if (!window.transcriptData || window.transcriptData.length === 0) return;
            
            const segmentDuration = totalDuration / window.transcriptData.length;
            
            window.transcriptData.forEach(function(transcript, index) {
                const startTime = index * segmentDuration;
                const endTime = Math.min((index + 1) * segmentDuration, totalDuration);
                
                const color = transcript.speaker === 'user' 
                    ? 'rgba(59, 130, 246, 0.3)'  // Blue for user
                    : 'rgba(16, 185, 129, 0.3)'; // Green for assistant
                
                regions.addRegion({
                    id: `transcript-${index}`,
                    start: startTime,
                    end: endTime,
                    color: color,
                    drag: false,
                    resize: false,
                    content: transcript.content.substring(0, 50) + '...'
                });
            });
        }
        
        function updateTimeDisplay(current, total) {
            document.getElementById('currentTime').textContent = formatTime(current);
            document.getElementById('totalTime').textContent = formatTime(total);
        }
        
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }
        
        function seekToTranscript(transcriptId) {
            if (!wavesurfer || !window.transcriptData) return;
            
            const totalDuration = wavesurfer.getDuration();
            const segmentDuration = totalDuration / window.transcriptData.length;
            const startTime = transcriptId * segmentDuration;
            
            wavesurfer.setTime(startTime);
            highlightTranscriptById(`transcript-${transcriptId}`);
            
            // Start playing if not already playing
            if (!isPlaying) {
                wavesurfer.play();
            }
        }
        
        function highlightCurrentTranscript(currentTime) {
            if (!window.transcriptData) return;
            
            const totalDuration = wavesurfer.getDuration();
            const segmentDuration = totalDuration / window.transcriptData.length;
            const currentIndex = Math.floor(currentTime / segmentDuration);
            
            if (currentIndex >= 0 && currentIndex < window.transcriptData.length) {
                highlightTranscriptElement(currentIndex);
            }
        }
        
        function highlightTranscriptById(regionId) {
            const transcriptId = regionId.replace('transcript-', '');
            highlightTranscriptElement(parseInt(transcriptId));
        }
        
        function highlightTranscriptElement(transcriptIndex) {
            // Clear previous highlights
            clearTranscriptHighlight();
            
            // Highlight current transcript
            const transcriptElement = document.querySelector(`[data-transcript-id="${transcriptIndex}"]`);
            if (transcriptElement) {
                transcriptElement.classList.add('highlighted');
                
                // Scroll into view
                transcriptElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }
        }
        
        function clearTranscriptHighlight() {
            document.querySelectorAll('.transcript-item').forEach(function(element) {
                element.classList.remove('highlighted');
            });
        }
        
        // Auto-scroll transcript to bottom initially
        const transcriptContainer = document.querySelector('#transcriptContainer');
        if (transcriptContainer) {
            setTimeout(() => {
                transcriptContainer.scrollTop = transcriptContainer.scrollHeight;
            }, 500);
        }
        
        // Add smooth scrolling and animations
        document.addEventListener('DOMContentLoaded', function() {
            // Animate cards on load
            const cards = document.querySelectorAll('.glass-effect');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Add click handlers for transcript items
        function addTranscriptClickHandlers() {
            document.querySelectorAll('.transcript-item').forEach(function(element) {
                element.addEventListener('click', function() {
                    const transcriptId = parseInt(this.getAttribute('data-transcript-id'));
                    seekToTranscript(transcriptId);
                });
            });
        }
    </script>
</body>
</html> 